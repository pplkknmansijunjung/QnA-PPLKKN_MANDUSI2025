<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Lihat Pesan & Kesan ðŸ’Œ</title>
  <style>
    body {
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(135deg, #1f1c2c, #928dab);
      color: white;
      margin: 0;
      padding: 20px;
      text-align: center;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    h2 {
      font-size: 1.8rem;
      color: #ffda79;
      margin-bottom: 20px;
      text-shadow: 0 2px 6px rgba(0,0,0,0.3);
    }

    #messages {
      width: 100%;
      max-width: 700px;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .person {
      border-radius: 16px;
      margin: 14px 0;
      padding: 18px;
      width: 90%;
      box-shadow: 0 0 15px rgba(0,0,0,0.2);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      color: #333;
      background: white;
      text-align: left;
      word-break: break-word;
    }

    .person:hover {
      transform: scale(1.02);
      box-shadow: 0 0 20px rgba(255,255,255,0.2);
    }

    .name {
      font-weight: 700;
      font-size: 1.2rem;
      margin-bottom: 8px;
    }

    .label {
      font-weight: 600;
      margin-top: 10px;
      display: block;
    }

    .message, .impression {
      font-size: 1rem;
      background: rgba(255,255,255,0.4);
      border-radius: 10px;
      padding: 8px 10px;
      margin-top: 5px;
      line-height: 1.5;
      white-space: pre-wrap;
    }

    .buttons {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin-top: 12px;
    }

    button {
      border: none;
      color: white;
      border-radius: 8px;
      padding: 8px 12px;
      cursor: pointer;
      font-size: 0.9rem;
      transition: transform 0.2s ease, opacity 0.3s ease;
    }

    button:hover {
      transform: scale(1.05);
      opacity: 0.9;
    }

    footer {
      margin-top: 25px;
      font-size: 0.9rem;
      color: #ddd;
      padding-bottom: 10px;
    }

    @media (max-width: 600px) {
      h2 { font-size: 1.4rem; }
      .person { width: 95%; padding: 15px; }
      .name { font-size: 1.1rem; }
      .message, .impression { font-size: 0.95rem; }
      button { font-size: 0.85rem; padding: 7px 10px; }
    }
  </style>
</head>
<body>
  <h2>Pesan & Kesan yang Masuk ðŸ’¬</h2>
  <div id="messages">Memuat data...</div>
  <footer>ðŸ’— QnA Anonim - Mandusi 2025 ðŸ’—</footer>

  <script>
    // ðŸ”— Ganti dengan URL CSV kamu dari Google Sheets (mode "Publish to web" > CSV)
    const sheetUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vS4TM31-o_JeOx7sLGI_6361vQNNaFOj7fKzhTGr_klzPSmgURFKmBkaCwUAUQcevOVW4Mmz2Rx0wJb/pub?output=csv";

    // ðŸŽ¨ Warna lembut untuk tiap kartu
    const pastelColors = [
      "#FFB6C1", "#FFDAB9", "#E6E6FA", "#B0E0E6", "#F0E68C",
      "#98FB98", "#FFA07A", "#D8BFD8", "#AFEEEE", "#FFFACD"
    ];

    fetch(sheetUrl)
      .then(response => response.text())
      .then(csv => {
        const rows = csv.split("\n").slice(1);
        const container = document.getElementById("messages");
        container.innerHTML = "";

        rows.forEach((row, index) => {
          const cols = row.split(",");
          if (cols.length >= 4) {
            const nama = cols[1]?.trim() || "Anonim";
            const pesan = cols[2]?.trim() || "";
            const kesan = cols[3]?.trim() || "";

            if (pesan || kesan) {
              // ðŸŽ¨ Ambil warna acak dari daftar pastel
              const color = pastelColors[index % pastelColors.length];
              const textShare = `ðŸ’Œ Pesan untuk ${nama}\n\nðŸ“© ${pesan}\nðŸ’­ ${kesan}\n\n#PesanKesanMandusi2025`;
              const encoded = encodeURIComponent(textShare);
              const waLink = `https://wa.me/?text=${encoded}`;

              const personDiv = document.createElement("div");
              personDiv.className = "person";
              personDiv.style.background = color;
              personDiv.innerHTML = `
                <div class="name">ðŸ‘¤ ${nama}</div>
                ${pesan ? `<div class="label">Pesan:</div><div class="message">${pesan}</div>` : ""}
                ${kesan ? `<div class="label">Kesan:</div><div class="impression">${kesan}</div>` : ""}
                <div class="buttons">
                  <button style="background:#25D366" onclick="window.open('${waLink}','_blank')">ðŸ“¤ WA Story</button>
                  <button style="background:#E1306C" onclick="copyText('${textShare.replace(/'/g, "\\'")}')">ðŸ“‹ IG Story</button>
                </div>
              `;
              container.appendChild(personDiv);
            }
          }
        });

        if (container.innerHTML.trim() === "") {
          container.innerHTML = "Belum ada pesan masuk ðŸ˜¢";
        }
      })
      .catch(err => {
        document.getElementById("messages").innerHTML = "Gagal memuat data ðŸ˜¢";
        console.error(err);
      });

    function copyText(text) {
      navigator.clipboard.writeText(text)
        .then(() => alert("Teks disalin! Tempelkan di story IG kamu ðŸ©·"))
        .catch(() => alert("Gagal menyalin teks ðŸ˜¢"));
    }
  </script>
</body>
</html>
